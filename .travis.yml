os: linux
arch: arm64
go: '1.18'
language: go
dist: xenial
sudo: true
services:
- docker
install:
- ARCH=`uname -p`
- echo $ARCH
- curl -LO https://storage.googleapis.com/kubernetes-release/release/v1.23.5/bin/linux/arm64/kubectl
- chmod +x ./kubectl
- sudo mv ./kubectl /usr/local/bin/kubectl
before_install:
- curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo apt-key add -
- sudo add-apt-repository "deb [arch=arm64] https://download.docker.com/linux/ubuntu
  $(lsb_release -cs) stable"
- sudo apt-get update
- sudo apt-get -y -o Dpkg::Options::="--force-confnew" install docker-ce
- docker version
- pip install awscli
- export PATH=$PATH:$HOME/.local/bin
- echo $(aws ecr get-login-password --region $AWS_DEFAULT_REGION) | docker login --username
  $DOCKER_USERNAME --password-stdin $ECR_REGISTRY
script:
- echo 1
env:
- SHA: "$(git rev-parse HEAD)"
- COMMIT_USER: $(git log --pretty=format:"%an" $SHA -1)
- COMMIT_CONTENT: $(git log --pretty=format:"%s" $SHA -1)
- SHORT_SHA: "$(git rev-parse --short HEAD)"
#- NOTIFY_SECRET: K2uwQT7db5735Br9arwQ1b
#- NOTIFY_URL: https://open.feishu.cn/open-apis/bot/v2/hook/dbad9c08-9a0e-483d-a551-fe941581c990
#- ECR_REGISTRY: 201672968307.dkr.ecr.ap-northeast-1.amazonaws.com
- HOLLA_API_GO_IMAGE: "$ECR_REGISTRY/holla-api-go:$SHA"
- AWS_DEFAULT_REGION: ap-northeast-1
- DOCKER_USERNAME: AWS
- NAMESPACE: holla-api-go
addons:
  deploy:
  - provider: script
    script: bash ./deploy.sh
    'on':
      branch:
      - travis-deploy-go
# jobs:
#   include:
#     #- dist: xenial
#     - dist: bionic
#     - dist: focal
    # - group: stable
    #   language: elixir
    #   dist: rhel8
    #   script: 
    #   - cat /etc/*-release
    #   - echo "Job 1"
    # - group: stable
    #   language: go
    #   dist: rhel8
    #   script: 
    #   - cat /etc/*-release
    #   - echo "Job 1"
    # - group: stable
    #   language: groovy
    #   dist: rhel8
    #   script: 
    #   - cat /etc/*-release
    #   - echo "Job 1"
    # - group: stable
    #   language: perl
    #   dist: rhel8
    #   script: 
    #   - cat /etc/*-release
    #   - echo "Job 1"
    # - group: stable
    #   language: php
    #   dist: rhel8
    #   script: 
    #   - cat /etc/*-release
    #   - echo "Job 1"
    # - group: stable
    #   language: python
    #   dist: rhel8
    #   script: 
    #   - cat /etc/*-release
    #   - echo "Job 1"
    # - group: stable
    #   language: ruby
    #   dist: rhel8
    #   script: 
    #   - cat /etc/*-release
    #   - echo "Job 1"





