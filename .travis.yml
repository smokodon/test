
script:
  - echo "deb [signed-by=/usr/share/keyrings/cloud.google.gpg] https://packages.cloud.google.com/apt cloud-sdk main" | sudo tee -a /etc/apt/sources.list.d/google-cloud-sdk.list
  - curl https://packages.cloud.google.com/apt/doc/apt-key.gpg | sudo apt-key --keyring /usr/share/keyrings/cloud.google.gpg add -
  - sudo apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 7123CB760FF18869
  - sudo apt-get update && sudo apt-get install -y google-cloud-cli google-cloud-sdk google-cloud-sdk-gke-gcloud-auth-plugin
  - psql -c 'create database travis_ci_test;' -U postgres
  - sudo netstat -plunt |grep postgres
  #- sudo apt-get install postgresql-13 postgresql-client-13
  - psql --version
#addons:
#  postgresql: 13
# virt: vm
#- sudo add-apt-repository -r deb http://apt.postgresql.org/pub/repos/apt bionic-pgdg
# - sudo apt update
#- sudo pip --disable-pip-version-check list --outdated --format=json | python3 -c "import json, sys; print('\n'.join([x['name'] for x in json.load(sys.stdin)]))" | xargs -n1 pip install -U
#- pip3 list --outdated --format=json | grep -v '^\-e' | cut -d = -f 1 | xargs -n1 pip3 install -U 
#- sudo apt-get install linux-headers-generic linux-image-gcp linux-image-generic 
#- sudo apt install -y linux-headers-generic linux-image-gcp linux-image-generic linux-modules-5.4.0-165-generic linux-modules-5.15.0-1042-gcp linux-gcp-5.15-headers-5.15.0-1042 linux-modules-5.15.0-1044-gcp
jobs:
 include:
  # - dist: xenial
  #   arch: arm64
  # - dist: bionic
  #   arch: arm64
  # - dist: focal
  #   arch: arm64
  # - dist: jammy
  #   arch: arm64

  # - dist: focal
  #   arch: arm64-graviton2
  # - dist: bionic
  #   arch: arm64-graviton2
  # - dist: jammy
  #   arch: arm64-graviton2
  # - dist: xenial
  #   arch: arm64-graviton2

  # - dist: xenial
  #   arch: ppc64le
  # - dist: bionic
  #   arch: ppc64le
  # - dist: focal
  #   arch: ppc64le
  # - dist: jammy
  #   arch: ppc64le
  # - dist: xenial
  #   arch: s390x
  # - dist: bionic
  #   arch: s390x
  # - dist: focal
  #   arch: s390x
  # - dist: jammy
  #   arch: s390x
  # - dist: trusty
  #   arch: amd64
  # - dist: xenial
  #   arch: amd64
  # - dist: bionic
  #   arch: amd64
  - dist: focal
    arch: amd64
    addons:
      postgresql: "12"
      apt:
        packages:
          - postgresql-12
          - postgresql-client-12
  - dist: focal
    arch: amd64
    group: previous
    addons:
      postgresql: "12"
      apt:
        packages:
          - postgresql-12
          - postgresql-client-12
  # - dist: jammy
  #   arch: amd64
